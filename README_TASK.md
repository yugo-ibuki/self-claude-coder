# 📝 Claude tmux自動実行システム - タスク管理ガイド

このガイドでは、Claude自動開発システムでのタスク作成・管理・運用方法を詳しく説明します。

## 📋 目次

1. [タスクシステム概要](#タスクシステム概要)
2. [タスクの設計原則](#タスクの設計原則)
3. [タスク作成](#タスク作成)
4. [タスク実行管理](#タスク実行管理)
5. [進捗監視](#進捗監視)
6. [タスク最適化](#タスク最適化)
7. [トラブルシューティング](#トラブルシューティング)

## タスクシステム概要

Claude自動開発システムのタスク管理は、明確に定義されたタスクを各専門Paneに自動分配し、段階的に処理を進める仕組みです。

### 📊 タスクの流れ

```
タスク作成 → 開発 → レビュー → テスト → ドキュメント → デプロイ → 完了
```

### 🎯 タスクシステムの特徴

- **自動分配**: 親Paneが適切な担当Paneにタスクを割り当て
- **重複防止**: 同一フェーズの並行実行を自動制御  
- **進捗追跡**: リアルタイムでタスク状況を監視
- **品質保証**: 各フェーズで専門的なチェックを実施

## タスクの設計原則

効果的なタスクを作成するための基本原則：

### 🎯 1. 適切な粒度

**推奨する粒度レベル：**
- ✅ **適切**: "ログイン機能の実装 - JWT認証とセッション管理を含む"
- ✅ **適切**: "ユーザー管理API - CRUD操作とバリデーション機能"
- ❌ **粗すぎ**: "フロントエンド作成"
- ❌ **細かすぎ**: "login.jsのhandleSubmit関数を修正"

**目安時間**: 1つのタスクは1-3時間で完了できる範囲

### 📋 2. 具体的な要件定義

各タスクには以下を含める：

```
例：良いタスクの記述
"ユーザー認証API実装
- JWT トークン生成・検証
- パスワードハッシュ化（bcrypt）
- 入力値バリデーション
- エラーハンドリング
- Express.js + TypeScript使用"
```

### 🔗 3. 依存関係の明確化

```
例：依存関係を考慮したタスク順序
task-001: データベースモデル設計
task-002: 認証API実装（task-001に依存）
task-003: フロントエンド認証画面（task-002に依存）
```

## タスク作成

### 📝 基本的なタスク作成

タスク作成スクリプトを使用してタスクを登録します：

```bash
# 基本構文
./.task/create_task.sh [タスクID] "[タスク内容]"

# 具体例
./.task/create_task.sh task-001 "ログイン機能の実装 - JWT認証とセッション管理を含む"

./.task/create_task.sh task-002 "ユーザー管理API実装
- CRUD操作（作成、読取、更新、削除）
- バリデーション機能
- エラーハンドリング
- Express.js + TypeScript使用"

./.task/create_task.sh task-003 "データベース設計
- ER図作成
- テーブル定義
- インデックス設計
- PostgreSQL使用"
```

### 🎯 効果的なタスク記述のコツ

#### ✅ 良い例

```bash
./.task/create_task.sh task-004 "商品管理画面のフロントエンド実装
- React + TypeScript
- 商品一覧表示（ページネーション付き）  
- 検索・フィルタリング機能
- 新規登録・編集フォーム
- レスポンシブデザイン対応"
```

#### ❌ 避けるべき例

```bash
# 粗すぎる
./.task/create_task.sh task-005 "フロントエンド作成"

# 細かすぎる  
./.task/create_task.sh task-006 "ProductList.tsxのuseEffect修正"

# 曖昧すぎる
./.task/create_task.sh task-007 "バグ修正"
```

## タスク実行管理

### 🚀 タスク開始

作成したタスクを実行に移すには、親Paneに指示を送ります：

```bash
# 特定のタスクを開始
"task-001の開発を開始してください"

# 複数タスクを順序指定
"task-001から順番に進めてください"

# 優先タスクの指定
"task-003を優先的に進めてください"

# 技術要件を含む指示
"React HooksとTypeScriptを使用してtask-004を実装してください"
```

### 📋 タスクの状態管理

各タスクは以下のフェーズを順番に進行します：

```
pending → development → review → testing → documentation → deployment → completed
```

#### フェーズ別の実行内容

- **development**: コード実装、機能作成
- **review**: コードレビュー、設計確認
- **testing**: テスト作成・実行、品質確認
- **documentation**: ドキュメント作成・更新
- **deployment**: 本番反映、運用準備

### 🔄 並行処理の制御

システムは自動的に以下を管理します：

- **重複防止**: 同じタスクの同じフェーズは1つのPaneでのみ実行
- **自動分配**: 空いているPaneに新しいタスクを自動割り当て
- **状態同期**: 全Paneの状況をリアルタイムで追跡

## 進捗監視

### 📊 状況確認コマンド

```bash
# 基本的な状況確認
./.task/status_check.sh

# リアルタイム監視（10秒おき）
watch -n 10 ./.task/status_check.sh

# 詳細ログ確認
tail -f .task/system.log

# 特定タスクのログ
tail -f .task/task-001/log

# 現在の割り当て状況
cat .task/panes/current_assignments | jq .
```

### 📈 進捗レポートの読み方

status_check.shの出力例：

```
🚀 タスク管理システム状況確認
==================================
📱 Pane状況:
  - 開発Pane (%31): busy (task-001/development)
  - レビューPane (%32): idle
  - テストPane (%33): idle  
  - ドキュメントPane (%34): idle
  - デプロイPane (%35): idle

📋 タスク状況:
  - task-001: development (進行中)
  - task-002: pending (待機中)  
  - task-003: completed (完了)

📊 システム統計:
  - 実行中タスク: 1
  - 待機中タスク: 1
  - 完了タスク: 1
```

### 🔍 各フェーズの確認ポイント

#### Development完了時
- 実装されたコードファイル
- 機能の動作確認
- エラーハンドリングの実装状況

#### Review完了時  
- レビューコメント
- コード品質評価
- 改善提案

#### Testing完了時
- テストケース
- テスト実行結果
- カバレッジレポート

#### Documentation完了時
- API仕様書
- README更新
- コメント・ドキュメント

#### Deployment完了時
- デプロイ手順書
- 本番環境での動作確認
- 運用ガイド

## トラブルシューティング

### 🔧 よくある問題と解決方法

#### 1. 作業が進まない

**症状**: 30分以上進捗がない、Paneが応答しない
```bash
# システム状況を確認
./.task/status_check.sh

# システム全体をリセット
./start_claude_system.sh  # 自動的に問題を修復
```

#### 2. タスクの質が期待と違う

**症状**: 実装方針や出力が想定と異なる
```bash
# より具体的な指示を親Paneに送信
"task-001を中断し、以下の技術要件で再実装してください：[具体的な要件]"
```

#### 3. 重複や競合が発生

**症状**: 複数のPaneが同じ作業をしている
```bash
# 緊急リセットで状態を初期化
./.task/status_check.sh  # 現在の状況確認
# 親Paneで："全タスクを一時停止して整理してください"
```

#### 4. システムが混乱している

**最終手段**: 完全リセット
```bash
# システム全体を初期状態に戻す
./start_claude_system.sh

# 新しいセッションで再開
tmux attach-session -t claude-dev
```

## 🎯 成功の指標

システムが期待通りに動作している場合：

- ✅ `./start_claude_system.sh` が問題なく完了する
- ✅ `.task/status_check.sh` で全Paneが「idle」状態
- ✅ 親Paneに指示を出すと、適切なPaneに作業が割り振られる
- ✅ 各フェーズ（開発→レビュー→テスト→ドキュメント→デプロイ）が順次進行する
- ✅ 実際に動作するコードやドキュメントが生成される

## タスク最適化

### 🎯 効率的なタスク設計

#### 1. バッチ処理でタスク作成

関連するタスクは一度に作成：

```bash
# 一連の機能開発
./.task/create_task.sh task-010 "ユーザー認証API - バックエンド実装"
./.task/create_task.sh task-011 "ユーザー認証UI - フロントエンド実装"  
./.task/create_task.sh task-012 "認証フロー - E2Eテスト作成"

# 完了後、次の機能群を作成
./.task/create_task.sh task-020 "商品管理API - バックエンド実装"
./.task/create_task.sh task-021 "商品管理UI - フロントエンド実装"
./.task/create_task.sh task-022 "商品管理 - E2Eテスト作成"
```

#### 2. 段階的な複雑度管理

```bash
# Phase 1: 基本機能
./.task/create_task.sh task-001 "基本ログイン機能（メール・パスワード）"

# Phase 2: 高度な機能
./.task/create_task.sh task-002 "2段階認証（TOTP）実装"

# Phase 3: 拡張機能
./.task/create_task.sh task-003 "ソーシャルログイン（Google, GitHub）"
```

### 🔄 タスクのライフサイクル管理

#### 修正・改善タスクの作成

```bash
# レビュー結果に基づく修正
./.task/create_task.sh task-001-fix "task-001のレビュー指摘事項対応
- セキュリティ強化（入力サニタイゼーション）
- エラーハンドリング改善
- ログ出力追加"

# テスト結果に基づく修正
./.task/create_task.sh task-002-bugfix "task-002のバグ修正
- パスワードバリデーション不具合
- セッションタイムアウト処理
- メモリリーク対応"
```

#### 優先度とタイミング調整

```bash
# 緊急度の高いタスク
./.task/create_task.sh task-urgent-001 "🚨 セキュリティ脆弱性対応 - SQLインジェクション修正"

# 依存関係を考慮した順序指定
# 親Paneへの指示：
"task-001が完了次第、task-002を開始してください"
"task-urgent-001を最優先で処理してください"
```

### 📊 パフォーマンス向上のコツ

#### 1. 並行作業の最適化

- 独立性の高いタスクを同時に進行
- フロントエンド・バックエンドの並行開発
- テスト・ドキュメント作成の並行処理

#### 2. 適切な粒度の維持

```
最適なタスク例：
✅ 1機能 = 1タスク
✅ 1-3時間の作業量
✅ 明確な完了基準
✅ 独立したテスト可能な単位
```

---

🎯 **タスク管理のマスターへの道**

効果的なタスク管理は、システムを最大限活用するための鍵です。小さなタスクから始めて、徐々に複雑な開発フローを構築していきましょう。

📖 **システム全体の運用について**: `README_CLAUDE.md` を参照してください。
